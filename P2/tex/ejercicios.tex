\documentclass[11pt]{article}

\usepackage[utf8]{inputenc}
\usepackage[spanish, es-tabla, es-nodecimaldot]{babel}
\usepackage{mathtools}
\usepackage{amssymb}
\usepackage{amsthm}

\usepackage{dsfont}

%Gummi|065|=)
\title{\textbf{Práctica 2}}
\author{Pedro Bonilla Nadal\\
		Johanna Capote Robayna\\
		Guillermo Galindo Ortuño}
\date{}

%No indent
\setlength\parindent{0pt}
\begin{document}

\maketitle

\textbf{Ejercicio 5.} Calcula el orden de precisión con respecto a $h$ de las siguiente fórmulas para la aproximación numérica de $f'(c)$: \\ \\

\textbf{a)} $f'(c) \simeq \frac{1}{6h}(-11f(c) + 18f(c + h) -9f(c + 2h) +2f(c+3h))$ \\ \\
\textbf{solución} \\
\underline{orden 1:} \\
$$f(c + h) = f(c) + hf'(\xi) \ ; \ f(c + 2h) = f(c) + 2hf'(\xi) \ ; \ f'(c + 3h) = f(c) + 3hf'(\xi)$$
$$f'(c) = \frac{1}{6h}(-11f(c) + 18  [f(c) + hf'(\xi)] - 9  [f(c) + 2hf'(\xi)] + 2 [f(c) + 3hf'(\xi)]) = $$
$$= \frac{1}{6h}(-11f(c) + 18f(c) - 9f(c) + 2f(c) + 18hf'(\xi) - 18hf'(\xi) + 6hf'(\xi)) = $$
$$= \frac{1}{6h}(6hf'(c)) = f'(c) $$
\underline{orden 2:} \\
$$ f(c + h) = f(c) + hf'(c) + \frac{h^{2}}{2!} f''(\xi)$$ $$ f(c + 2h) = f(c) + 2hf'(c) + \frac{4h^{2}}{2!} f''(\xi)$$ $$f'(c + 3h) = f(c) + 3hf'(c) + \frac{9h^{2}}{2!} f''(\xi) $$
$$f'(c) = \frac{1}{6h}(-11f(c) + 18  [f(c) + hf'(c) + \frac{h^{2}}{2!} f''(\xi)] - 9  [f(c) + 2hf'(c) + \frac{4h^{2}}{2!} f''(\xi)] +$$ $$ + 2 [f(c) + 3hf'(c) + \frac{9h^{2}}{2!} f''(\xi)]) = \frac{1}{6h}(6hf'(c) + f''(\xi)[\frac{18h^{2}}{4} - 9h^{2} + \frac{18h^{2}}{4}]) = $$ $$\frac{1}{6h}(6hf'(c) + f''(\xi)(\frac{18h^{2}}{2} + 9h^{2})) = f'(c)$$
\underline{orden 3:} \\
$$ f(c + h) = f(c) + hf'(c) + \frac{h^{2}}{2!} f''(c) + \frac{h^{3}}{3!}f'''(\xi)$$
$$ f(c + 2h) = f(c) + 2hf'(c) + \frac{4h^{2}}{2!} f''(c) + \frac{8h^{3}}{3!}f'''(\xi)$$ 
$$f'(c + 3h) = f(c) + 3hf'(c) + \frac{9h^{2}}{2!} f''(c) + \frac{27h^{3}}{3!}f'''(\xi)$$
$f'(c) = \frac{1}{6h}(6hf'(c) + f'''(\xi)[\frac{18h^{3}}{3!} - \frac{72h^{3}}{3!} + \frac{54h^{3}}{3!}]) =  \frac{1}{6h}(6hf'(c) + f'''(\xi)[3h^{3} - 12h^{3} + 9h^{3}]) = f'(c)  $ \\
\underline{orden 4:} \\
$$ f(c + h) = f(c) + hf'(c) + \frac{h^{2}}{2!} f''(c) + \frac{h^{3}}{3!}f'''(c) + \frac{h^{4}}{4!}f^{v}(\xi)$$
$$ f(c + 2h) = f(c) + 2hf'(c) + \frac{4h^{2}}{2!} f''(c) + \frac{8h^{3}}{3!}f'''(c) + \frac{16h^{4}}{4!}f^{v}(\xi)$$ 
$$f'(c + 3h) = f(c) + 3hf'(c) + \frac{9h^{2}}{2!} f''(c) + \frac{27h^{3}}{3!}f'''(c) + \frac{81h^{4}}{4!}f^{v}(\xi)$$
$f'(c) = \frac{1}{6h}(6hf'(c) + f^{v}(\xi)[\frac{18h^{4}}{4!} - \frac{144h^{4}}{4!} + \frac{162h^{4}}{4!}]) = \frac{1}{6h}(6hf'(c) + f^{v}(\xi)\frac{36h^{4}}{24}) \neq f'(c) $ \\


\textbf{Ejercicio 13.} Sea $$ \int_a^b f(x) dx \simeq \sum_{i=0}^n \alpha_i f(x_i),  $$
una fórmula de Newton-Cotes. Demuestra que:

\begin{itemize}
\item Si $n$ es par: $ \alpha_{n/2-i}=\alpha_{n/2+i}$ con $ i = 0,...,\frac{n}{2}$
\item Si $n$ es impar: $ \alpha_{i}=\alpha_{n-i}$ con $ i = 0,...,\frac{n-1}{2}$
\end{itemize}

{Solución.\\}

\begin{itemize}
\item Sabemos que $\alpha_{i}=\int_a^b l_i(x) dx $ con $l_i = \prod_{j = 0  \ j\neq i}^n \frac{(x-x_j)}{(x_i-x_j)}$

Además, podemos escribir los $x_i$ como $x_i= x_{n/2} + h(i-n/2)$, entonces:   $$x_{n/2-i}  = x_{n/2} + h(n/2-i-n/2)   = x_{n/2} - hi $$ 
$$x_{n/2+i} = x_{n/2} + h(n/2+i-n/2) = x_ {n/2} + hi $$

%Veamos primero que :
%$$ \prod_{j = 0  \ j\neq (n/2-i)}^n (x_{n/2} - hi -x_j) =  \prod_{j = 0  \ j\neq (n/2-i)}^n   (x_{n/2} - hi -   (x_{n/2} + h(j-n/2) )) = $$ $$  \prod_{j = 0  \ j\neq (n/2-i)}^n   (- hi -    h(j-n/2) ) =
 % \prod_{j = 0  \ j\neq (n/2-i)}^n    ( h (-i - j+n/2) ) = h^n$$

%Y de manera análoga:
%$$ \prod_{j = 0  \ j\neq (n/2-i)}^n (x_{n/2} + hi -x_j) =   \prod_{j = 0  \ j\neq (n/2-i)}^n   (  h(i - j+n/2 ))$$

No es dificil comprobar tampoco que :
$$  x_0 - x_{n/2-i} = x_{n/2+i}-x_n$$
$$ x_1 - x_{n/2-i} = x_{n/2+i}-x_{n-1}$$
$$\vdots$$
$$  x_n - x_{n/2-i} = x_{n/2+i}-x_0$$

Entonces se comprueba que $\prod_{j = 0  \ j\neq n/2-i}^n |\frac{1}{(x_i-x_j)}|=\prod_{j = 0  \ j\neq n/2+i}^n |\frac{1}{(x_i-x_j)}|$. Además, podemos ver que tb son iguales en signo, pues cada uno tendrá tantos nodos positivos como el otro negativos, y al ser $n$ par el productorio es de longitud par. Por todo esto si uno tiene impares negativos el otro tendrá  n-impares negativos, es decir, impares. Como esto se cumple de manera analoga para el caso par, podemos deducir que tienen el mismo signo.\\

Consideremos entonces si: $$\int_a^b  \prod_{j = 0  \ j\neq n/2-i}^n (x-x_j)  dx = \int_a^b  \prod_{j = 0  \ j\neq n/2+i}^n (x-x_j)  dx$$
O de manera equivalente:
 \begin{equation}
 \int_a^b (x-x_0)...(x-x_{n/2-i-1}) (x-x_{n/2-i+1}) ... (x-x_n)dx =
 \end{equation}

 \begin{equation}
  \int_a^b (x-x_0)...(x-x_{n/2+i-1}) (x-x_{n/2+i+1}) ... (x-x_n)dx 
\end{equation}
 
 Para solucionar esto haremos un cambio de variable que será la simetría respecto el punto medio en la integral (2) y después usando que $x_i - x_{n/2} = x_{n/2}-x_{n-i}$ : 
 
 $$\int_b^a - (2x_{n/2}-x-x_0) ...(2x_{n/2}-x-x_{n/2+i-1}) (2x_{n/2}-x-x_{n/2+i+1})...(2x_{n/2}-x-x_n) = $$
 $$\int_a^b (x_n-x)(x_{n-1}-x) ...(x_{n-(n/2+i-1)}-x) (x_{n-(n/2+i+1)}-x)...(x_0-x) = $$
 $$\int_a^b (x_n-x)(x_{n-1}-x) ...(x_{n/2-i+1}-x) (x_{n/2-i-1)}-x)...(x_0-x)$$
  Que es (1), considerando igualdad en el signo al haber pares polinomios .
  
  \item De manera analoga, comprobamos primero que:
  $$ x_0  - x_i = x_{n-i} - x_n $$
  $$ x_1  - x_i = x_{n-i} - x_{n-1} $$
 $$ \vdots$$
  $$ x_n  - x_i = x_{n-i} - x_0 $$
 
 Y por lo tanto tenemos el mismo valor absoluto en el denominador de cadas uno de nuestras interpolaciones $l_i$,$l_{n-i}$ pero con signo opuesto.
 
 Entonces tenemos que comprobar que la integrales (3), (4) nos salen iguales en valor absoluto, pero con signo opuesto
  \begin{equation}
 \int_a^b (x-x_0)...(x-x_{i-1}) (x-x_{i+1}) ... (x-x_n)dx =
 \end{equation}

 \begin{equation}
  \int_a^b (x-x_0)...(x-x_{n-i-1}) (x-x_{n-i+1}) ... (x-x_n)dx 
\end{equation}

Y realizando en 4 el cambio utilizado anteriormente nos queda:

$$  \int_a^b (x_n-x)...x_{i+1}-x) (x_{i-1}-x) ... (x_0-x)dx $$

Que de manera obvia tendrá el mismo valor absoluto, pero al haber impares factores, signo opuesto.

\end{itemize}

\textbf{Ejercicio 20.}

\end{document}
